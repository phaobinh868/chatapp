{"remainingRequest":"E:\\projects\\chat-app\\source\\front\\node_modules\\thread-loader\\dist\\cjs.js!E:\\projects\\chat-app\\source\\front\\node_modules\\babel-loader\\lib\\index.js!E:\\projects\\chat-app\\source\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\projects\\chat-app\\source\\front\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\projects\\chat-app\\source\\front\\src\\components\\MessageList.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\projects\\chat-app\\source\\front\\src\\components\\MessageList.vue","mtime":1627028094261},{"path":"E:\\projects\\chat-app\\source\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\projects\\chat-app\\source\\front\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\projects\\chat-app\\source\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\projects\\chat-app\\source\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\projects\\chat-app\\source\\front\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovcHJvamVjdHMvY2hhdC1hcHAvc291cmNlL2Zyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgTWVzc2FnZSBmcm9tICJAL2NvbXBvbmVudHMvTWVzc2FnZS52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIk1lc3NhZ2VMaXN0IiwKICBwcm9wczogWydtZXNzYWdlcyddLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzY3JvbGxBcmVhOiBudWxsLAogICAgICBsb2FkZWQ6IGZhbHNlLAogICAgICBsYXN0Q3JlYXRlZEF0OiBudWxsLAogICAgICB0aW1lb3V0U2Nyb2xsOiBudWxsCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgTWVzc2FnZTogTWVzc2FnZQogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWyJnZXRVc2VyIiwgImdldFNvY2tldCIsICJnZXRSb29tIl0pKSwKICBtZXRob2RzOiB7CiAgICBzY3JvbGxUb0xhc3Q6IGZ1bmN0aW9uIHNjcm9sbFRvTGFzdCgpIHsKICAgICAgdGhpcy5zY3JvbGxBcmVhLnNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsQXJlYS5zY3JvbGxIZWlnaHQgLSB0aGlzLnNjcm9sbEFyZWEuY2xpZW50SGVpZ2h0OwogICAgfSwKICAgIGhhbmRsZVNjcm9sbDogZnVuY3Rpb24gaGFuZGxlU2Nyb2xsKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dFNjcm9sbCk7CgogICAgICBpZiAodGhpcy5zY3JvbGxBcmVhLnNjcm9sbFRvcCA8IDIwICYmIHRoaXMuc2Nyb2xsQXJlYS5zY3JvbGxIZWlnaHQgLSB0aGlzLnNjcm9sbEFyZWEuY2xpZW50SGVpZ2h0ID4gMCkgewogICAgICAgIHRoaXMudGltZW91dFNjcm9sbCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMuZ2V0U29ja2V0LmVtaXQoJ2xvYWRNb3JlTWVzc2FnZScsIHsKICAgICAgICAgICAgcm9vbUlkOiBfdGhpcy5nZXRSb29tLl9pZCwKICAgICAgICAgICAgbGFzdENyZWF0ZWRBdDogX3RoaXMubGFzdENyZWF0ZWRBdAogICAgICAgICAgfSk7CiAgICAgICAgfSwgMTAwMCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLnNjcm9sbEFyZWEgPSB0aGlzLiRyZWZzLnNjcm9sbEFyZWE7CiAgICB0aGlzLnNjcm9sbFRvTGFzdCgpOwogICAgdGhpcy5zY3JvbGxBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuaGFuZGxlU2Nyb2xsKTsKICB9LAogIHVwZGF0ZWQ6IGZ1bmN0aW9uIHVwZGF0ZWQoKSB7CiAgICBpZiAodGhpcy5zY3JvbGxBcmVhLnNjcm9sbEhlaWdodCAtIHRoaXMuc2Nyb2xsQXJlYS5jbGllbnRIZWlnaHQgLSB0aGlzLnNjcm9sbEFyZWEuc2Nyb2xsVG9wIDwgMjAwIHx8ICF0aGlzLmxvYWRlZCkgdGhpcy5zY3JvbGxUb0xhc3QoKTsKICAgIHRoaXMubG9hZGVkID0gdHJ1ZTsKICAgIGlmICh0aGlzLm1lc3NhZ2VzLmxlbmd0aCkgdGhpcy5sYXN0Q3JlYXRlZEF0ID0gdGhpcy5tZXNzYWdlc1swXS5jcmVhdGVkQXQ7CiAgfSwKICB1bm1vdW50ZWQ6IGZ1bmN0aW9uIHVubW91bnRlZCgpIHsKICAgIHRoaXMuc2Nyb2xsQXJlYS5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgfQp9Ow=="},{"version":3,"sources":["E:\\projects\\chat-app\\source\\front\\src\\components\\MessageList.vue"],"names":[],"mappings":";AAUA,SAAS,UAAT,QAA2B,MAA3B;AACA,OAAO,OAAP,MAAoB,0BAApB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,aADO;AAEb,EAAA,KAAK,EAAE,CAAC,UAAD,CAFM;AAGb,EAAA,IAAI,EAAE,gBAAW;AACb,WAAO;AACH,MAAA,UAAU,EAAE,IADT;AAEH,MAAA,MAAM,EAAE,KAFL;AAGH,MAAA,aAAa,EAAE,IAHZ;AAIH,MAAA,aAAa,EAAE;AAJZ,KAAP;AAMH,GAVY;AAWb,EAAA,UAAU,EAAE;AACV,IAAA,OAAO,EAAP;AADU,GAXC;AAcb,EAAA,QAAQ,oBACH,UAAU,CAAC,CAAC,SAAD,EAAY,WAAZ,EAAyB,SAAzB,CAAD,CADP,CAdK;AAiBb,EAAA,OAAO,EAAE;AACP,IAAA,YADO,0BACQ;AACb,WAAK,UAAL,CAAgB,SAAhB,GAA4B,KAAK,UAAL,CAAgB,YAAhB,GAA+B,KAAK,UAAL,CAAgB,YAA3E;AACD,KAHM;AAIP,IAAA,YAJO,0BAIO;AAAA;;AACZ,MAAA,YAAY,CAAC,KAAK,aAAN,CAAZ;;AACA,UAAG,KAAK,UAAL,CAAgB,SAAhB,GAA4B,EAA5B,IAAkC,KAAK,UAAL,CAAgB,YAAhB,GAA+B,KAAK,UAAL,CAAgB,YAA/C,GAA8D,CAAnG,EAAqG;AACnG,aAAK,aAAL,GAAqB,UAAU,CAAC,YAAM;AAClC,UAAA,KAAI,CAAC,SAAL,CAAe,IAAf,CAAoB,iBAApB,EAAuC;AACrC,YAAA,MAAM,EAAE,KAAI,CAAC,OAAL,CAAa,GADgB;AAErC,YAAA,aAAa,EAAE,KAAI,CAAC;AAFiB,WAAvC;AAIH,SAL8B,EAK5B,IAL4B,CAA/B;AAMF;AACF;AAdO,GAjBI;AAiCb,EAAA,OAjCa,qBAiCH;AACR,SAAK,UAAL,GAAkB,KAAK,KAAL,CAAW,UAA7B;AACA,SAAK,YAAL;AACA,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,QAAjC,EAA2C,KAAK,YAAhD;AACD,GArCY;AAsCb,EAAA,OAtCa,qBAsCH;AACR,QAAI,KAAK,UAAL,CAAgB,YAAhB,GAA+B,KAAK,UAAL,CAAgB,YAAhD,GAA8D,KAAK,UAAL,CAAgB,SAA9E,GAA0F,GAA1F,IAAiG,CAAC,KAAK,MAA1G,EAAkH,KAAK,YAAL;AAClH,SAAK,MAAL,GAAc,IAAd;AACA,QAAG,KAAK,QAAL,CAAc,MAAjB,EAAyB,KAAK,aAAL,GAAqB,KAAK,QAAL,CAAc,CAAd,EAAiB,SAAtC;AAC1B,GA1CY;AA2Cb,EAAA,SA3Ca,uBA2CA;AACX,SAAK,UAAL,CAAgB,mBAAhB,CAAoC,QAApC,EAA8C,KAAK,YAAnD;AACD;AA7CY,CAAf","sourcesContent":["<template>\r\n  <div class=\"flex-1 message-area\" ref=\"scrollArea\">\r\n    <template v-if=\"messages && messages.length\">\r\n    <Message v-for=\"message in messages\" :key=\"message._id\" :message=\"message\" :mine=\"message.user._id == getUser._id?true:false\" />\r\n    </template>\r\n    <p v-else>There are no messages yet</p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport Message from \"@/components/Message.vue\";\r\n\r\nexport default {\r\n  name: \"MessageList\",\r\n  props: ['messages'],\r\n  data: function() {\r\n      return {\r\n          scrollArea: null,\r\n          loaded: false,\r\n          lastCreatedAt: null,\r\n          timeoutScroll: null\r\n      };\r\n  },\r\n  components: {\r\n    Message,\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"getUser\", \"getSocket\", \"getRoom\"])\r\n  },\r\n  methods: {\r\n    scrollToLast() {\r\n      this.scrollArea.scrollTop = this.scrollArea.scrollHeight - this.scrollArea.clientHeight;\r\n    },\r\n    handleScroll(){\r\n      clearTimeout(this.timeoutScroll);\r\n      if(this.scrollArea.scrollTop < 20 && this.scrollArea.scrollHeight - this.scrollArea.clientHeight > 0){\r\n        this.timeoutScroll = setTimeout(() => {\r\n            this.getSocket.emit('loadMoreMessage', {\r\n              roomId: this.getRoom._id,\r\n              lastCreatedAt: this.lastCreatedAt\r\n            });\r\n        }, 1000);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.scrollArea = this.$refs.scrollArea;\r\n    this.scrollToLast();\r\n    this.scrollArea.addEventListener('scroll', this.handleScroll);\r\n  },\r\n  updated() {\r\n    if((this.scrollArea.scrollHeight - this.scrollArea.clientHeight)-this.scrollArea.scrollTop < 200 || !this.loaded) this.scrollToLast();\r\n    this.loaded = true;\r\n    if(this.messages.length) this.lastCreatedAt = this.messages[0].createdAt;\r\n  },\r\n  unmounted () {\r\n    this.scrollArea.removeEventListener('scroll', this.handleScroll);\r\n  },\r\n};\r\n</script>"],"sourceRoot":""}]}