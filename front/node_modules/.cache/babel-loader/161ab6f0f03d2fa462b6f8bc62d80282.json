{"remainingRequest":"E:\\projects\\chat-app\\front\\node_modules\\babel-loader\\lib\\index.js!E:\\projects\\chat-app\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\projects\\chat-app\\front\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\projects\\chat-app\\front\\src\\components\\MessageList.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\projects\\chat-app\\front\\src\\components\\MessageList.vue","mtime":1627011954938},{"path":"E:\\projects\\chat-app\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\projects\\chat-app\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\projects\\chat-app\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\projects\\chat-app\\front\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovcHJvamVjdHMvY2hhdC1hcHAvZnJvbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7CmltcG9ydCBNZXNzYWdlIGZyb20gIkAvY29tcG9uZW50cy9NZXNzYWdlLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWVzc2FnZUxpc3QiLAogIHByb3BzOiBbJ21lc3NhZ2VzJ10sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNjcm9sbEFyZWE6IG51bGwsCiAgICAgIGxvYWRlZDogZmFsc2UsCiAgICAgIGxhc3RDcmVhdGVkQXQ6IG51bGwsCiAgICAgIHRpbWVvdXRTY3JvbGw6IG51bGwKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBNZXNzYWdlOiBNZXNzYWdlCiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwR2V0dGVycyhbImdldFVzZXIiLCAiZ2V0U29ja2V0IiwgImdldFJvb20iXSkpLAogIG1ldGhvZHM6IHsKICAgIHNjcm9sbFRvTGFzdDogZnVuY3Rpb24gc2Nyb2xsVG9MYXN0KCkgewogICAgICB0aGlzLnNjcm9sbEFyZWEuc2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxBcmVhLnNjcm9sbEhlaWdodCAtIHRoaXMuc2Nyb2xsQXJlYS5jbGllbnRIZWlnaHQ7CiAgICB9LAogICAgaGFuZGxlU2Nyb2xsOiBmdW5jdGlvbiBoYW5kbGVTY3JvbGwoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRTY3JvbGwpOwogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHRoaXMudGltZW91dFNjcm9sbCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGF0LnNjcm9sbEFyZWEuc2Nyb2xsVG9wIDwgMjAgJiYgdGhhdC5zY3JvbGxBcmVhLnNjcm9sbEhlaWdodCAtIHRoYXQuc2Nyb2xsQXJlYS5jbGllbnRIZWlnaHQgPiAwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygibG9hZE1vcmVNZXNzYWdlIik7CiAgICAgICAgICB0aGF0LmdldFNvY2tldC5lbWl0KCdsb2FkTW9yZU1lc3NhZ2UnLCB7CiAgICAgICAgICAgIHJvb21JZDogdGhhdC5nZXRSb29tLl9pZCwKICAgICAgICAgICAgbGFzdENyZWF0ZWRBdDogdGhhdC5sYXN0Q3JlYXRlZEF0CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIDEwMDApOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuc2Nyb2xsQXJlYSA9IHRoaXMuJHJlZnMuc2Nyb2xsQXJlYTsKICAgIHRoaXMuc2Nyb2xsVG9MYXN0KCk7CiAgICB0aGlzLnNjcm9sbEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5oYW5kbGVTY3JvbGwpOwogIH0sCiAgdXBkYXRlZDogZnVuY3Rpb24gdXBkYXRlZCgpIHsKICAgIGlmICh0aGlzLnNjcm9sbEFyZWEuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5zY3JvbGxBcmVhLmNsaWVudEhlaWdodCAtIHRoaXMuc2Nyb2xsQXJlYS5zY3JvbGxUb3AgPCAyMDAgfHwgIXRoaXMubG9hZGVkKSB0aGlzLnNjcm9sbFRvTGFzdCgpOwogICAgdGhpcy5sb2FkZWQgPSB0cnVlOwogICAgaWYgKHRoaXMubWVzc2FnZXMubGVuZ3RoKSB0aGlzLmxhc3RDcmVhdGVkQXQgPSB0aGlzLm1lc3NhZ2VzWzBdLmNyZWF0ZWRBdDsKICB9LAogIHVubW91bnRlZDogZnVuY3Rpb24gdW5tb3VudGVkKCkgewogICAgdGhpcy5zY3JvbGxBcmVhLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuaGFuZGxlU2Nyb2xsKTsKICB9Cn07"},{"version":3,"sources":["E:\\projects\\chat-app\\front\\src\\components\\MessageList.vue"],"names":[],"mappings":";AAOA,SAAS,UAAT,QAA2B,MAA3B;AACA,OAAO,OAAP,MAAoB,0BAApB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,aADO;AAEb,EAAA,KAAK,EAAE,CAAC,UAAD,CAFM;AAGb,EAAA,IAAI,EAAE,gBAAW;AACb,WAAO;AACH,MAAA,UAAU,EAAE,IADT;AAEH,MAAA,MAAM,EAAE,KAFL;AAGH,MAAA,aAAa,EAAE,IAHZ;AAIH,MAAA,aAAa,EAAE;AAJZ,KAAP;AAMH,GAVY;AAWb,EAAA,UAAU,EAAE;AACV,IAAA,OAAO,EAAP;AADU,GAXC;AAcb,EAAA,QAAQ,oBACH,UAAU,CAAC,CAAC,SAAD,EAAY,WAAZ,EAAyB,SAAzB,CAAD,CADP,CAdK;AAiBb,EAAA,OAAO,EAAE;AACP,IAAA,YADO,0BACQ;AACb,WAAK,UAAL,CAAgB,SAAhB,GAA4B,KAAK,UAAL,CAAgB,YAAhB,GAA+B,KAAK,UAAL,CAAgB,YAA3E;AACD,KAHM;AAIP,IAAA,YAJO,0BAIO;AACZ,MAAA,YAAY,CAAC,KAAK,aAAN,CAAZ;AACA,UAAI,IAAG,GAAI,IAAX;AACA,WAAK,aAAL,GAAqB,UAAU,CAAC,YAAU;AACxC,YAAG,IAAI,CAAC,UAAL,CAAgB,SAAhB,GAA4B,EAA5B,IAAkC,IAAI,CAAC,UAAL,CAAgB,YAAhB,GAA+B,IAAI,CAAC,UAAL,CAAgB,YAA/C,GAA8D,CAAnG,EAAqG;AACnG,UAAA,OAAO,CAAC,GAAR,CAAY,iBAAZ;AACA,UAAA,IAAI,CAAC,SAAL,CAAe,IAAf,CAAoB,iBAApB,EAAuC;AACrC,YAAA,MAAM,EAAE,IAAI,CAAC,OAAL,CAAa,GADgB;AAErC,YAAA,aAAa,EAAE,IAAI,CAAC;AAFiB,WAAvC;AAIF;AACD,OAR8B,EAQ5B,IAR4B,CAA/B;AASF;AAhBO,GAjBI;AAmCb,EAAA,OAnCa,qBAmCH;AACR,SAAK,UAAL,GAAkB,KAAK,KAAL,CAAW,UAA7B;AACA,SAAK,YAAL;AACA,SAAK,UAAL,CAAgB,gBAAhB,CAAiC,QAAjC,EAA2C,KAAK,YAAhD;AACD,GAvCY;AAwCb,EAAA,OAxCa,qBAwCH;AACR,QAAI,KAAK,UAAL,CAAgB,YAAhB,GAA+B,KAAK,UAAL,CAAgB,YAAhD,GAA8D,KAAK,UAAL,CAAgB,SAA9E,GAA0F,GAA1F,IAAiG,CAAC,KAAK,MAA1G,EAAkH,KAAK,YAAL;AAClH,SAAK,MAAL,GAAc,IAAd;AACA,QAAG,KAAK,QAAL,CAAc,MAAjB,EAAyB,KAAK,aAAL,GAAqB,KAAK,QAAL,CAAc,CAAd,EAAiB,SAAtC;AAC1B,GA5CY;AA6Cb,EAAA,SA7Ca,uBA6CA;AACX,SAAK,UAAL,CAAgB,mBAAhB,CAAoC,QAApC,EAA8C,KAAK,YAAnD;AACD;AA/CY,CAAf","sourcesContent":["<template>\r\n  <div class=\"flex-1 message-area\" ref=\"scrollArea\">\r\n    <p>There are no messages yet</p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport Message from \"@/components/Message.vue\";\r\n\r\nexport default {\r\n  name: \"MessageList\",\r\n  props: ['messages'],\r\n  data: function() {\r\n      return {\r\n          scrollArea: null,\r\n          loaded: false,\r\n          lastCreatedAt: null,\r\n          timeoutScroll: null\r\n      };\r\n  },\r\n  components: {\r\n    Message,\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"getUser\", \"getSocket\", \"getRoom\"])\r\n  },\r\n  methods: {\r\n    scrollToLast() {\r\n      this.scrollArea.scrollTop = this.scrollArea.scrollHeight - this.scrollArea.clientHeight;\r\n    },\r\n    handleScroll(){\r\n      clearTimeout(this.timeoutScroll);\r\n      var that = this;\r\n      this.timeoutScroll = setTimeout(function(){\r\n        if(that.scrollArea.scrollTop < 20 && that.scrollArea.scrollHeight - that.scrollArea.clientHeight > 0){\r\n          console.log(\"loadMoreMessage\");\r\n          that.getSocket.emit('loadMoreMessage', {\r\n            roomId: that.getRoom._id,\r\n            lastCreatedAt: that.lastCreatedAt\r\n          });\r\n        }\r\n      }, 1000);\r\n    }\r\n  },\r\n  mounted() {\r\n    this.scrollArea = this.$refs.scrollArea;\r\n    this.scrollToLast();\r\n    this.scrollArea.addEventListener('scroll', this.handleScroll);\r\n  },\r\n  updated() {\r\n    if((this.scrollArea.scrollHeight - this.scrollArea.clientHeight)-this.scrollArea.scrollTop < 200 || !this.loaded) this.scrollToLast();\r\n    this.loaded = true;\r\n    if(this.messages.length) this.lastCreatedAt = this.messages[0].createdAt;\r\n  },\r\n  unmounted () {\r\n    this.scrollArea.removeEventListener('scroll', this.handleScroll);\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.message-area {\r\n  padding: 0px 16px;\r\n  overflow: auto;\r\n}\r\n.message {\r\n  margin-top: 26px;\r\n  font-size: 14px;\r\n  width: 100%;\r\n}\r\n.message:first-child {\r\n  margin-top: 0;\r\n}\r\n.message.left-message {\r\n}\r\n.message.right-message {\r\n  display: flex;\r\n}\r\n.message .message-user {\r\n  text-align: left;\r\n  margin: 0;\r\n  margin-bottom: 8px;\r\n}\r\n.message .message-content {\r\n  padding: 16px;\r\n  text-align: left;\r\n  width: 60%;\r\n  border-radius: 10px;\r\n  position: relative;\r\n}\r\n.message.left-message .message-content {\r\n  background: #f6f6f6;\r\n  border-bottom-left-radius: 0;\r\n}\r\n.message.right-message .message-content {\r\n  float: right;\r\n  text-align: right;\r\n  background: #5db075;\r\n  color: #fff;\r\n  border-bottom-right-radius: 0px;\r\n}\r\n.message .message-content:after {\r\n  content: \" \";\r\n  position: absolute;\r\n  width: 0;\r\n  height: 0;\r\n  bottom: -20px;\r\n  border: 12px solid;\r\n}\r\n.message.left-message .message-content:after {\r\n  right: auto;\r\n  left: 0px;\r\n  border-color: #f6f6f6 transparent transparent #f6f6f6;\r\n}\r\n.message.right-message .message-content:after {\r\n  left: auto;\r\n  right: 0px;\r\n  border-color: #5db075 #5db075 transparent transparent;\r\n}\r\n</style>\r\n"],"sourceRoot":""}]}